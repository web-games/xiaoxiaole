(()=>{"use strict";var t,o=(t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)},function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});const n=function(t){function n(o){var e=t.call(this,o)||this;return n.NAME="game"+n.NUM++,e.view.style.width="100%",document.body.prepend(e.view),e}return o(n,t),Object.defineProperty(n.prototype,"stageWidth",{get:function(){return this.screen.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"stageHeight",{get:function(){return this.screen.height},enumerable:!1,configurable:!0}),n.NAME="game",n.NUM=0,n}(PIXI.Application);var e=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const r=function(t){function o(n){var e=t.call(this,o.NAME,n)||this;return e.loadingScene.on("init_complete",e.initComplete,e),e}return e(o,t),o.prototype.initComplete=function(){var t=this,o=new PIXI.Loader;o.add(["./resources/images/main_background.jpg","./resources/images/animal1.png","./resources/images/animal2.png","./resources/images/animal3.png","./resources/images/animal4.png","./resources/images/animal5.png","./resources/images/animal6.png","./resources/images/animal7.png","./resources/images/animal8.png"]),o.once("complete",(function(){setTimeout((function(){t.sendNotification(I.TO_GAME,{from:t.loadingScene})}),500)})),o.on("progress",(function(t){console.log("加载百分比"+t.progress+"%")})),o.load()},Object.defineProperty(o.prototype,"loadingScene",{get:function(){return this.viewComponent},enumerable:!1,configurable:!0}),o.NAME="loading_scene_mediator",o}(puremvc.Mediator);var i=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const a=function(t){function o(o){var n=t.call(this)||this;return n.game=null,n.stageWidth=0,n.stageHeight=0,n.game=o,n.stageWidth=o.stageWidth,n.stageHeight=o.stageHeight,n}return i(o,t),o.prototype.init=function(t){},o.prototype.destroy=function(){},o.prototype.removeAllChildren=function(t,o,n){void 0===n&&(n=1);var e=t.children;if(e&&e.length>0)for(var r=e.length-1;r>=0;r--){var i=e[r];console.log(n,r,i.name),this.removeAllChildren(i,n+1),i.parent&&i.parent.removeChild(i)}o&&t.parent&&t.parent.removeChild(t)},o}(PIXI.Container);var c=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const s=function(t){function o(o){return t.call(this,o)||this}return c(o,t),o.prototype.init=function(){var t,o,n,e,r,i=this;t=new PIXI.Container,this.addChild(t),r=new PIXI.Text("Text1",{fill:"#FFFFFF"}),t.addChild(r),r.x=this.stageWidth/2,r.y=this.stageHeight,r.anchor.x=.5,r.anchor.y=1,r.alpha=0,window.TweenMax.to(r,1,{alpha:1,ease:window.Strong.easeOut,delay:1}),window.TweenMax.to(r.position,1,{y:this.stageHeight-760,ease:window.Elastic.easeOut,delay:.8}),r.name="txt1",r.rotation=-.05,window.TweenMax.to(r,.1,{rotation:.1,ease:window.Linear.easeNone,repeat:-1,yoyo:!0,delay:1.2}),(o=PIXI.Sprite.from("pic4.jpg")).position.x=0,o.position.y=100,t.addChild(o),o.alpha=0,window.TweenMax.to(o,.6,{alpha:1}),(n=PIXI.Sprite.from("pic5.png")).anchor.x=.5,n.anchor.y=.5,n.position.x=this.stageWidth/2,n.position.y=this.stageHeight/2,t.addChild(n),n.scale.x=n.scale.y=0,window.TweenMax.to(n.scale,1,{x:1,y:1,ease:window.Elastic.easeOut,delay:.8}),(e=PIXI.Sprite.from("btn2.jpg")).anchor.x=.5,e.anchor.y=.5,e.position.x=this.stageWidth/2,e.position.y=n.position.y+240,t.addChild(e),e.scale.x=e.scale.y=0,window.TweenMax.to(e.scale,1,{x:1,y:1,ease:window.Elastic.easeOut,delay:.9}),e.interactive=!0,e.mousedown=e.touchstart=function(){i.sceneOut()}},o.prototype.sceneOut=function(){var t=this;window.TweenMax.to(this,.4,{alpha:0,onComplete:function(){t.emit(o.CLICK_START)}})},o.NAME="start_scene",o.CLICK_START="click_start",o}(a);var u=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const l=function(t){function o(n){var e=t.call(this,o.NAME,n)||this;return e.startScene.on(s.CLICK_START,(function(){e.sendNotification(I.TO_GAME,{from:e.startScene})})),e}return u(o,t),o.prototype.listNotificationInterests=function(){return[]},o.prototype.handleNotification=function(t){t.getName()},Object.defineProperty(o.prototype,"startScene",{get:function(){return this.viewComponent},enumerable:!1,configurable:!0}),o.NAME="start_scene_mediator",o}(puremvc.Mediator);var p=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const f=function(t){function o(){var n=t.call(this,o.NAME)||this;return n.map=null,n.swapFruitStack=[],n.score=0,n.map=new d(n),n}return p(o,t),o.prototype.addSwapFruit=function(t){if(this.swapFruitStack.push(t),this.swapFruitStack.length>=2){var n=this.swapFruitStack[this.swapFruitStack.length-2],e=this.swapFruitStack[this.swapFruitStack.length-1];for(this.check4direction(n.row,n.col,e.row,e.col)?(this.map.swap(n.row,n.col,e.row,e.col),this.sendNotification(o.SWAP_FRUIT,[n,e],"success")):this.sendNotification(o.SWAP_FRUIT,[n,e],"fail");this.swapFruitStack.length;)this.swapFruitStack.shift()}},o.prototype.check4direction=function(t,o,n,e){return Math.abs(o-e)<=1&&t===n||Math.abs(t-n)<=1&&o===e},o.NAME="game_proxy",o.CHANGE_SCORE="change_score",o.ADD_FRUIT="add_fruit",o.DELETE_FRUIT="delete_fruit",o.DROP_FRUIT="drop_fruit",o.SWAP_FRUIT="swap_fruit",o}(puremvc.Proxy);var h=function(t,o,n){if(n||2===arguments.length)for(var e,r=0,i=o.length;r<i;r++)!e&&r in o||(e||(e=Array.prototype.slice.call(o,0,r)),e[r]=o[r]);return t.concat(e||Array.prototype.slice.call(o))};const d=function(){function t(t){this.rows=10,this.cols=5,this.data=[[2,4,2,4,2],[4,5,4,5,4],[4,5,5,5,4],[3,4,5,4,3],[1,1,4,1,1],[6,3,6,3,6],[3,7,3,7,3],[3,7,7,7,3],[2,3,7,3,2],[8,8,3,8,8]],this.proxy=null,this.proxy=t}return t.prototype.swap=function(t,o,n,e){var r=this,i=this.data[t][o];this.data[t][o]=this.data[n][e],this.data[n][e]=i,setTimeout((function(){r.check()}),300)},t.prototype.check=function(){var o=this,n=h(h([],this.horizontalCheck(),!0),this.verticalCheck(),!0).filter((function(t){return t}));if(console.log(n),n.length)n.forEach((function(t){var n=t[0],e=t[1];o.data[n][e]=null})),this.proxy.sendNotification(f.DELETE_FRUIT,n),setTimeout((function(){for(var t={},n=0;n<o.cols;n++){t[n]=[];for(var e,r=function(){if(null===o.data[i][n])for(var r=i;r--;)null!==o.data[r][n]&&((e=t[n].find((function(t){return t.row===r&&t.col===n})))||(e={row:r,col:n,drop:0},t[n].push(e)),e.drop++)},i=0;i<o.rows;i++)r();t[n].sort((function(t,o){return o.row-t.row}))}for(var a in t)t[a].forEach((function(t){var n=t.row,e=t.col,r=t.drop,i=o.data[n][e];o.data[n][e]=null,o.data[n+r][e]=i}));console.log(o.data),o.proxy.sendNotification(f.DROP_FRUIT,t),setTimeout((function(){o.check()}),300)}),1e3);else{for(var e=[],r=0;r<this.cols;r++)for(var i=0;i<this.rows;i++)null===this.data[i][r]&&(this.data[i][r]=this.getAnimalIndex(),e.push({row:i,col:r,value:this.data[i][r],animate:{from:{x:this.cols*t.GridWidth/2,y:0},to:{x:r*t.GridWidth+t.GridWidth/2,y:i*t.GridHeight+t.GridHeight/2}}}));e.length&&(this.proxy.sendNotification(f.ADD_FRUIT,e),this.check())}},t.prototype.horizontalCheck=function(){for(var t=[],o=0;o<this.rows;o++)for(var n=1,e=0;e<this.cols;e++){var r=this.data[o][e],i=this.data[o][e+1];if(null!=r||null!==i)if(r===i)n++;else{if(n>=3){this.proxy.score+=n,this.proxy.sendNotification(f.CHANGE_SCORE,this.proxy.score);for(var a=n,c="";a;){var s=o,u=e-(a-1);t.push([s,u]),c+="(".concat(s,",").concat(u,")"),a--}console.log("横向：连续".concat(n,"个相同").concat(c,",值为").concat(r))}n=1}}return t},t.prototype.verticalCheck=function(){for(var t=[],o=0;o<this.cols;o++)for(var n=1,e=0;e<this.rows;e++){var r=this.data[e][o],i=this.data[e+1]&&this.data[e+1][o]||null;if(null!=r||null!==i)if(r===i)n++;else{if(n>=3){this.proxy.score+=n,this.proxy.sendNotification(f.CHANGE_SCORE,this.proxy.score);for(var a=n,c="";a;){var s=e-(a-1),u=o;t.push([s,u]),c+="(".concat(s,",").concat(u,")"),a--}console.log("纵向：连续".concat(n,"个相同").concat(c,",值为").concat(r))}n=1}}return t},t.prototype.getAnimalIndex=function(){return parseInt(String(8*Math.random()))+1},t.GridWidth=80,t.GridHeight=80,t}();var y=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const _=function(t){function o(o,n,e){var r=t.call(this)||this;r.text=null,r.row=null,r.col=null,r.value=null,r.row=o,r.col=n,r.value=e;var i=PIXI.Sprite.from("./resources/images/animal".concat(e,".png"));r.addChild(i),i.anchor.set(.5);var a=new PIXI.Text("",{fontSize:10,fill:16777215});return r.addChild(a),a.anchor.set(.5,.5),r.text=a,r.buttonMode=!0,r.interactive=!0,r.update(),r}return y(o,t),o.prototype.setRowCol=function(t,o,n){void 0===n&&(n=!0),this.row=t,this.col=o,this.update();var e=o*d.GridWidth+d.GridWidth/2,r=t*d.GridHeight+d.GridHeight/2;n?window.TweenMax.to(this,.3,{x:e,y:r,ease:"none"}):(this.x=e,this.y=r)},o.prototype.update=function(){},o}(PIXI.Container);var w=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),g=PIXI.Container,m=PIXI.Graphics,v=PIXI.Sprite,O=PIXI.Text;const T=function(t){function o(o){var n=t.call(this,o)||this;return n.fruits={},n.scoreText=null,n.animalContainer=null,n}return w(o,t),o.prototype.init=function(o){var n=this;t.prototype.init.call(this,o),this.filters=[new PIXI.filters.GodrayFilter({alpha:.5})];var e=o.rows,r=o.cols,i=o.data,a=v.from("./resources/images/main_background.jpg");this.addChild(a);var c=new O("",{fill:16777215,fontSize:64});this.addChild(c),c.anchor.set(.5,.5),c.x=this.stageWidth/2,c.y=65,c.filters=[new PIXI.filters.GlowFilter({color:65390,distance:15,innerStrength:.1,outerStrength:2.5})],this.scoreText=c,this.updateScore(0);var s=new g;this.addChild(s),s.x=(this.stageWidth-r*d.GridWidth)/2,s.y=(this.stageHeight-e*d.GridHeight)/2,this.animalContainer=s;var u=new m;s.addChild(u);for(var l=0;l<e;l++)for(var p=0;p<r;p++){var f=p*d.GridWidth,h=l*d.GridHeight;u.beginFill(0,l%2==0?p%2==0?.6:.4:p%2!=0?.6:.4),u.moveTo(f,h),u.lineTo(f+d.GridWidth,h),u.lineTo(f+d.GridWidth,h+d.GridHeight),u.lineTo(f,h+d.GridHeight),u.closePath(),u.endFill(),this.addFruit({row:l,col:p,value:i[l][p],animate:{from:{x:r*d.GridWidth/2,y:0},to:{x:p*d.GridWidth+d.GridWidth/2,y:l*d.GridHeight+d.GridHeight/2}}})}setTimeout((function(){n.emit("init_complete")}),1e3)},o.prototype.addFruit=function(t){var n=this;Array.isArray(t)||(t=[t]),t.forEach((function(t){var e=t.row,r=t.col,i=t.value,a=t.animate,c=new _(e,r,i);if(n.animalContainer.addChild(c),a){var s=a.from,u=a.to;window.TweenMax.fromTo([c],.3,s,u)}else c.x=r*d.GridWidth+d.GridWidth/2,c.y=e*d.GridHeight+d.GridHeight/2;c.on("pointerdown",(function(t){c.filters=[new PIXI.filters.OutlineFilter(2,10092441)],n.emit(o.CLICK_FRUIT,t.currentTarget)})),n.fruits["".concat(e,"_").concat(r)]=c}))},o.prototype.swapFruit=function(t,o){var n=t[0],e=t[1],r=n.row,i=n.col,a=e.row,c=e.col,s=this.fruits["".concat(r,"_").concat(i)],u=this.fruits["".concat(a,"_").concat(c)];"success"===o?(s.setRowCol(a,c),u.setRowCol(r,i),this.fruits["".concat(r,"_").concat(i)]=u,this.fruits["".concat(a,"_").concat(c)]=s,setTimeout((function(){s.filters=[],u.filters=[]}),300)):"fail"===o&&(s.rotation=-.05,u.rotation=-.05,window.TweenMax.to(s,.1,{rotation:.1,ease:window.Linear.easeNone,repeat:5,yoyo:!0}),window.TweenMax.to(u,.1,{rotation:.1,ease:window.Linear.easeNone,repeat:5,yoyo:!0}),setTimeout((function(){s.filters=[],u.filters=[]}),300))},o.prototype.deleteFruit=function(t){var o=this,n=[];t.forEach((function(t){n.find((function(o){return t[0]===o[0]&&t[1]===o[1]}))||n.push(t)})),n.forEach((function(t){var n=t[0],e=t[1],r=o.fruits["".concat(n,"_").concat(e)];window.TweenMax.to(r.scale,1,{x:0,y:0,ease:"power1.inOut"}),window.TweenMax.to(r,1,{alpha:0,ease:"none"}),o.fruits["".concat(n,"_").concat(e)]=null}))},o.prototype.dropFruit=function(t){var o=this;for(var n in t)t[n].forEach((function(t){var n=t.row,e=t.col,r=t.drop,i=o.fruits["".concat(n,"_").concat(e)];i.setRowCol(n+r,e),o.fruits["".concat(n,"_").concat(e)]=null,o.fruits["".concat(n+r,"_").concat(e)]=i}))},o.prototype.updateScore=function(t){t<1e3?t="000".concat(t):t<100?t="00".concat(t):t<10&&(t="0".concat(t)),this.scoreText.text="Score: "+t},o.NAME="game_scene",o.CLICK_FRUIT="click_fruit",o}(a);var C=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const S=function(t){function o(){return t.call(this)||this}return C(o,t),o.prototype.execute=function(t){console.log("SceneCommand notification:",t);var n=t.getName(),e=t.getBody(),r=this.facade.retrieveProxy(f.NAME);switch(n){case o.ADD_FRUIT_STACK:r.addSwapFruit(e);break;case o.CHECK:r.map.check()}},o.ADD_FRUIT_STACK="add_fruit_stack",o.CHECK="check",o}(puremvc.SimpleCommand);var b=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const x=function(t){function o(n){var e=t.call(this,o.NAME,n)||this;return e.gameScene.on("init_complete",(function(){e.sendNotification(S.CHECK)})),e.gameScene.on(T.CLICK_FRUIT,(function(t){var o=t.row,n=t.col,r=t.value;e.sendNotification(S.ADD_FRUIT_STACK,{row:o,col:n,value:r})})),e}return b(o,t),o.prototype.listNotificationInterests=function(){return[f.ADD_FRUIT,f.DELETE_FRUIT,f.DROP_FRUIT,f.SWAP_FRUIT,f.CHANGE_SCORE]},o.prototype.handleNotification=function(t){console.log("GameSceneMediator notification:",t);var o=t.getName(),n=t.getBody(),e=t.getType();switch(o){case f.ADD_FRUIT:this.gameScene.addFruit(n);break;case f.DELETE_FRUIT:this.gameScene.deleteFruit(n);break;case f.DROP_FRUIT:this.gameScene.dropFruit(n);break;case f.SWAP_FRUIT:this.gameScene.swapFruit(n,e);break;case f.CHANGE_SCORE:this.gameScene.updateScore(n)}},Object.defineProperty(o.prototype,"gameScene",{get:function(){return this.viewComponent},enumerable:!1,configurable:!0}),o.NAME="game_scene_mediator",o}(puremvc.Mediator);var A=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const I=function(t){function o(){return t.call(this)||this}return A(o,t),o.prototype.execute=function(t){console.log("SceneCommand notification:",t);var n=this.facade.game,e=t.getName(),i=t.getBody().from;switch(i&&(i.destroy(),i.parent&&i.parent.removeChild(i)),e){case o.TO_LOADING:var a=this.facade.retrieveMediator(r.NAME).loadingScene;n.stage.addChild(a),a.init();break;case o.TO_START:var c=this.facade.retrieveMediator(l.NAME).startScene;n.stage.addChild(c),c.init();break;case o.TO_GAME:var s=this.facade.retrieveMediator(x.NAME).gameScene;n.stage.addChild(s),s.init(this.facade.retrieveProxy(f.NAME).map)}},o.TO_LOADING="to_loading",o.TO_START="to_start",o.TO_GAME="to_game",o}(puremvc.SimpleCommand);var E=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const P=function(t){function o(){return t.call(this)||this}return E(o,t),o.prototype.execute=function(){this.facade.registerProxy(new f)},o}(puremvc.SimpleCommand);var F=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),j=PIXI.Text;const M=function(t){function o(o){return t.call(this,o)||this}return F(o,t),o.prototype.init=function(){var t=new j("加载中...",{fill:"#FFFFFF"});this.addChild(t),t.anchor.set(.5,.5),t.x=this.stageWidth/2,t.y=this.stageHeight/2,this.emit("init_complete")},o.NAME="loading_scene",o}(a);var N=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const R=function(t){function o(){return t.call(this)||this}return N(o,t),o.prototype.execute=function(t){var o=t.getBody(),n=new M(o);this.facade.registerMediator(new r(n));var e=new s(o);this.facade.registerMediator(new l(e));var i=new T(o);this.facade.registerMediator(new x(i))},o}(puremvc.SimpleCommand);var G=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const k=function(t){function o(){return t.call(this)||this}return G(o,t),o.prototype.execute=function(){this.facade.registerCommand(I.TO_LOADING,I),this.facade.registerCommand(I.TO_START,I),this.facade.registerCommand(I.TO_GAME,I),this.facade.registerCommand(S.CHECK,S),this.facade.registerCommand(S.ADD_FRUIT_STACK,S)},o}(puremvc.SimpleCommand);var H=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const W=function(t){function o(){return t.call(this)||this}return H(o,t),o.prototype.initializeMacroCommand=function(){this.addSubCommand(P),this.addSubCommand(R),this.addSubCommand(k)},o}(puremvc.MacroCommand);var U=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),D=puremvc.Facade;(function(t){function o(o){var n=t.call(this,o)||this;return n._game=null,n}return U(o,t),o.getInstance=function(t){return null==t?null:(null==D.instanceMap[t]&&(D.instanceMap[t]=new o(t)),D.instanceMap[t])},o.prototype.initializeModel=function(){t.prototype.initializeModel.call(this)},o.prototype.initializeView=function(){t.prototype.initializeView.call(this)},o.prototype.initializeController=function(){t.prototype.initializeController.call(this),this.registerCommand(o.STARTUP,W)},o.prototype.startup=function(){var t=document.documentElement.clientWidth||document.body.clientWidth,e=document.documentElement.clientHeight||document.body.clientHeight,r=e>t?e/t*640:t/e*640;this.game=new n({width:640,height:r,backgroundColor:1087931}),this.sendNotification(o.STARTUP,this.game),this.removeCommand(o.STARTUP),this.sendNotification(I.TO_LOADING,{from:null})},o.prototype.destory=function(){this.game&&(this.game.destroy(!0),this.game=null),window.TweenMax.killAll()},Object.defineProperty(o.prototype,"game",{get:function(){return this._game},set:function(t){this._game=t},enumerable:!1,configurable:!0}),o.STARTUP="startup",o.instance=null,o})(D).getInstance(n.NAME).startup()})();