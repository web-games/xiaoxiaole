{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/org/proxy/GameProxy.ts","webpack:///./src/org/command/SceneCommand.ts","webpack:///./src/org/mediator/view/Scene.ts","webpack:///./src/org/proxy/model/Map.ts","webpack:///./src/Game.ts","webpack:///./src/org/mediator/LoadingSceneMediator.ts","webpack:///./src/org/mediator/StartSceneMediator.ts","webpack:///./src/org/mediator/view/start/StartScene.ts","webpack:///./src/org/mediator/GameSceneMediator.ts","webpack:///./src/org/mediator/view/game/GameScene.ts","webpack:///./src/org/command/GameCommand.ts","webpack:///./src/main.ts","webpack:///./src/org/ApplicationFacade.ts","webpack:///./src/org/mediator/view/game/Fruit.ts","webpack:///./src/org/command/startup/StartupCommand.ts","webpack:///./src/org/command/startup/ModelPrepCommand.ts","webpack:///./src/org/command/startup/ViewPrepCommand.ts","webpack:///./src/org/mediator/view/loading/LoadingScene.ts","webpack:///./src/org/command/startup/ControllerPrepCommand.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Proxy","puremvc","Map_1","__importDefault","GameProxy","_super","_this","this","NAME","map","swapFruitStack","score","default","__extends","addSwapFruit","data","push","length","node1","node2","check4direction","row","col","swap","sendNotification","SWAP_FRUIT","shift","row1","col1","row2","col2","Math","abs","CHANGE_SCORE","ADD_FRUIT","DELETE_FRUIT","DROP_FRUIT","SimpleCommand","LoadingSceneMediator_1","StartSceneMediator_1","GameSceneMediator_1","GameProxy_1","SceneCommand","execute","notification","console","log","game","facade","getName","from","getBody","destroy","parent","removeChild","TO_LOADING","loadingScene","retrieveMediator","stage","addChild","init","TO_START","startScene","TO_GAME","gameScene","retrieveProxy","Scene","stageWidth","stageHeight","removeAllChildren","obj","bo","num","children","ele","PIXI","Container","Map","proxy","rows","cols","temp","setTimeout","check","result","horizontalCheck","concat","verticalCheck","filter","forEach","_a","drop","j","preNode","m_1","find","node","sort","a","b","arr","getAnimalIndex","animate","x","GridWidth","y","to","GridHeight","same","curVal","nextVal","grid","parseInt","String","random","Game","config","NUM","view","style","width","document","body","appendChild","screen","height","Application","Mediator","SceneCommand_1","LoadingMediator","viewComponent","on","initComplete","assetLoader","add","once","e","progress","load","StartScene_1","StartSceneMediator","CLICK_START","listNotificationInterests","handleNotification","StartScene","_stage2Container","_pic4","_pic5","_btn2","_txt1","Text","fill","anchor","alpha","window","TweenMax","ease","Strong","easeOut","delay","position","Elastic","rotation","Linear","easeNone","repeat","yoyo","Sprite","scale","interactive","mousedown","touchstart","sceneOut","onComplete","emit","GameScene_1","GameCommand_1","GameSceneMediator","CHECK","CLICK_FRUIT","ADD_FRUIT_STACK","type","getType","addFruit","deleteFruit","dropFruit","swapFruit","updateScore","Graphics","Scene_1","Fruit_1","GameScene","fruits","scoreText","animalContainer","filters","bgImage","fontSize","set","color","distance","innerStrength","outerStrength","bg","startX","startY","beginFill","moveTo","lineTo","closePath","endFill","Array","isArray","fruit","fromTo","event","currentTarget","fruit1","fruit2","setRowCol","item1","item2","text","GameCommand","gameProxy","Game_1","getInstance","startup","Facade","StartupCommand_1","ApplicationFacade","_game","instanceMap","initializeModel","initializeView","initializeController","registerCommand","STARTUP","windowWidth","documentElement","clientWidth","windowHeight","clientHeight","backgroundColor","removeCommand","destory","killAll","instance","Fruit","sprite","buttonMode","update","move","MacroCommand","ModelPrepCommand_1","ViewPrepCommand_1","ControllerPrepCommand_1","StartupCommand","initializeMacroCommand","addSubCommand","ModelPrepCommand","registerProxy","LoadingScene_1","ViewPrepCommand","note","registerMediator","LoadingScene","ControllerPrepCommand"],"mappings":"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","file":"app.0f6241b.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","import Proxy = puremvc.Proxy;\nimport IProxy = puremvc.IProxy;\nimport Map from \"./model/Map\";\n\nexport default class GameProxy extends Proxy implements IProxy {\n  public static NAME: string = \"game_proxy\"\n\n  public static CHANGE_SCORE:string =\"change_score\"\n\n  public static ADD_FRUIT: string = \"add_fruit\";\n\n  public static DELETE_FRUIT: string = \"delete_fruit\";\n\n  public static DROP_FRUIT: string = \"drop_fruit\";\n\n  public static SWAP_FRUIT: string = \"swap_fruit\";\n\n  // 地图数据\n  public map: Map = null;\n\n  // 记录要交换的水果\n  public swapFruitStack: any[] = []\n\n  public score: number = 0;\n\n  constructor() {\n    super(GameProxy.NAME)\n\n    this.map = new Map(this)\n  }\n\n  public addSwapFruit(data) {\n    this.swapFruitStack.push(data);\n    // console.log(this.swapFruitStack)\n\n    if (this.swapFruitStack.length >= 2) {\n      let node1 = this.swapFruitStack[this.swapFruitStack.length - 2]\n      let node2 = this.swapFruitStack[this.swapFruitStack.length - 1]\n\n      if (this.check4direction(node1.row, node1.col, node2.row, node2.col)) {\n        // console.log(`(${node1.row},${node1.col}),(${node2.row},${node2.col})`)\n        this.map.swap(node1.row, node1.col, node2.row, node2.col)\n\n        this.sendNotification(GameProxy.SWAP_FRUIT, [node1, node2], \"success\")\n      } else {\n        this.sendNotification(GameProxy.SWAP_FRUIT, [node1, node2], \"fail\")\n      }\n\n      while (this.swapFruitStack.length) {\n        this.swapFruitStack.shift()\n      }\n    }\n  }\n\n  private check4direction(row1, col1, row2, col2) {\n    if (Math.abs(col1 - col2) <= 1 && row1 === row2) {\n      return true\n    } else if (Math.abs(row1 - row2) <= 1 && col1 === col2) {\n      return true\n    }\n    return false;\n  }\n}\n","import SimpleCommand = puremvc.SimpleCommand\nimport ICommand = puremvc.ICommand\nimport INotification = puremvc.INotification\n\nimport Game from \"../../Game\";\nimport Scene from \"../mediator/view/Scene\";\nimport ApplicationFacade from \"../ApplicationFacade\";\n\nimport LoadingScene from \"../mediator/view/loading/LoadingScene\";\nimport LoadingSceneMediator from \"../mediator/LoadingSceneMediator\";\n\nimport StartScene from \"../mediator/view/start/StartScene\";\nimport StartSceneMediator from \"../mediator/StartSceneMediator\";\nimport GameScene from \"../mediator/view/game/GameScene\";\nimport GameSceneMediator from \"../mediator/GameSceneMediator\";\nimport GameProxy from \"../proxy/GameProxy\";\n\nexport default class SceneCommand extends SimpleCommand implements ICommand {\n\n  public static TO_LOADING = \"to_loading\"\n\n  public static TO_START = \"to_start\"\n\n  public static TO_GAME = \"to_game\"\n\n  constructor() {\n    super()\n  }\n\n  public execute(notification: INotification) {\n    console.log(\"SceneCommand notification:\", notification)\n\n    let game: Game = (this.facade as ApplicationFacade).game;\n    let name = notification.getName()\n    let body = notification.getBody()\n    let {from} = body\n\n    if (from) {\n      from = from as Scene;\n      from.destroy();\n      if (from.parent) {\n        from.parent.removeChild(from)\n      }\n    }\n\n    switch (name) {\n      case SceneCommand.TO_LOADING:\n        let loadingScene: LoadingScene = (this.facade.retrieveMediator(LoadingSceneMediator.NAME) as LoadingSceneMediator).loadingScene\n        game.stage.addChild(loadingScene)\n        loadingScene.init();\n        break\n      case SceneCommand.TO_START:\n        let startScene: StartScene = (this.facade.retrieveMediator(StartSceneMediator.NAME) as StartSceneMediator).startScene;\n        game.stage.addChild(startScene)\n        startScene.init();\n        break\n      case SceneCommand.TO_GAME:\n        let gameScene: GameScene = (this.facade.retrieveMediator(GameSceneMediator.NAME) as GameSceneMediator).gameScene;\n        game.stage.addChild(gameScene)\n        gameScene.init((this.facade.retrieveProxy(GameProxy.NAME) as GameProxy).map);\n        break\n    }\n  }\n}","import Container = PIXI.Container\nimport Game from \"../../../Game\";\n\nexport const enum SceneEvent {\n  INIT_COMPLETE = \"init_complete\",\n  CREATE_COMPLETE = \"create_complete\",\n}\n\nexport default class Scene extends Container {\n  public game: Game = null;\n  public stageWidth: number = 0;\n  public stageHeight: number = 0;\n\n  constructor(game: Game) {\n    super()\n    this.game = game;\n    this.stageWidth = game.stageWidth\n    this.stageHeight = game.stageHeight\n  }\n\n  protected init(data?: any) {\n\n  }\n\n  public destroy() {\n\n  }\n\n  public removeAllChildren(obj, bo, num = 1) {\n    let {children} = obj\n    if (children && children.length > 0) {\n      let i = children.length - 1\n      for (i; i >= 0; i--) {\n        let ele = children[i]\n        console.log(num, i, ele.name);\n        this.removeAllChildren(ele, num + 1);\n\n        if (ele.parent) ele.parent.removeChild(ele);\n      }\n    }\n\n    if (bo && obj.parent) obj.parent.removeChild(obj);\n  }\n}","import GameProxy from \"../GameProxy\";\n\nexport default class Map {\n  public static GridWidth = 80\n  public static GridHeight = 80\n\n  public rows = 10\n  public cols = 5\n\n  public data = [\n    [2, 4, 2, 4, 2],\n    [4, 5, 4, 5, 4],\n    [4, 5, 5, 5, 4],\n    [3, 4, 5, 4, 3],\n    [1, 1, 4, 1, 1],\n    [6, 3, 6, 3, 6],\n    [3, 7, 3, 7, 3],\n    [3, 7, 7, 7, 3],\n    [2, 3, 7, 3, 2],\n    [8, 8, 3, 8, 8],\n  ]\n\n  private proxy: GameProxy = null;\n\n  constructor(proxy) {\n    this.proxy = proxy;\n\n    // for (var i = 0; i < this.rows; i++) {\n    //   for (var j = 0; j < this.cols; j++) {\n    //     this.data[i][j] = this.getAnimalIndex()\n    //   }\n    // }\n  }\n\n  swap(row1, col1, row2, col2) {\n    let temp = this.data[row1][col1];\n\n    this.data[row1][col1] = this.data[row2][col2];\n    this.data[row2][col2] = temp;\n\n    // console.log(row1, col1, row2, col2, this.data)\n\n    setTimeout(() => {\n      this.check();\n    }, 300)\n  }\n\n  check() {\n    var result = [...this.horizontalCheck(), ...this.verticalCheck()].filter(ele => ele)\n    console.log(result)\n    if (result.length) {\n      result.forEach(([row, col]) => {\n        this.data[row][col] = null;\n      })\n\n      this.proxy.sendNotification(GameProxy.DELETE_FRUIT, result)\n\n      setTimeout(() => {\n        var drop = {}\n        for (var j = 0; j < this.cols; j++) {\n          drop[j] = []\n          for (var i = 0; i < this.rows; i++) {\n            if (this.data[i][j] === null) {\n              let m = i\n              while (m--) {\n                if (this.data[m][j] !== null) {\n                  var preNode = drop[j].find(node => (node.row === m && node.col === j))\n                  if (!preNode) {\n                    preNode = {row: m, col: j, drop: 0}\n                    drop[j].push(preNode);\n                  }\n\n                  preNode.drop++\n                }\n              }\n            }\n          }\n          drop[j].sort((a, b) => (b.row - a.row))\n        }\n        // console.log(drop)\n\n        for (var key in drop) {\n          drop[key].forEach(({row, col, drop}) => {\n            var temp = this.data[row][col]\n            this.data[row][col] = null;\n            this.data[row + drop][col] = temp;\n          })\n        }\n\n        console.log(this.data)\n\n        this.proxy.sendNotification(GameProxy.DROP_FRUIT, drop)\n\n        setTimeout(() => {\n          this.check()\n        }, 300)\n      }, 1000)\n    } else {\n      let arr = []\n      for (var j = 0; j < this.cols; j++) {\n        for (var i = 0; i < this.rows; i++) {\n          if (this.data[i][j] === null) {\n            // console.log(`填充：${i}行${j}列`)\n            this.data[i][j] = this.getAnimalIndex()\n\n            arr.push({\n              row: i,\n              col: j,\n              value: this.data[i][j],\n              animate: {\n                from: {x: (this.cols * Map.GridWidth) / 2, y: 0},\n                to: {x: (j * Map.GridWidth + Map.GridWidth / 2), y: (i * Map.GridHeight + Map.GridHeight / 2)}\n              }\n            })\n          }\n        }\n        // console.log(\"\\n\")\n      }\n\n      if (arr.length) {\n        this.proxy.sendNotification(GameProxy.ADD_FRUIT, arr)\n        this.check()\n      }\n    }\n  }\n\n  horizontalCheck() {\n    var arr = []\n    for (var i = 0; i < this.rows; i++) {\n      var same = 1\n      for (var j = 0; j < this.cols; j++) {\n        var curVal = this.data[i][j]\n        var nextVal = this.data[i][j + 1]\n        // console.log(`i=${i}, j=${j}, curVal=${curVal}, nextVal=${nextVal}`)\n\n        if (curVal == null && nextVal === null)\n          continue\n\n        if (curVal === nextVal) {\n          same++\n        } else {\n          if (same >= 3) {\n            // console.log(`(${i},${j})`)\n            this.proxy.score += same;\n            this.proxy.sendNotification(GameProxy.CHANGE_SCORE, this.proxy.score)\n\n            var num = same\n            var grid = ``\n            while (num) {\n              var row = i\n              var col = j - (num - 1)\n              // console.log(row, col, num)\n              arr.push([row, col])\n\n              grid += `(${row},${col})`\n\n              num--\n            }\n            console.log(`横向：连续${same}个相同${grid},值为${curVal}`)\n          }\n\n          same = 1\n        }\n      }\n    }\n    return arr\n  }\n\n  verticalCheck() {\n    var arr = []\n    for (var j = 0; j < this.cols; j++) {\n      var same = 1\n      for (var i = 0; i < this.rows; i++) {\n        var curVal = this.data[i][j]\n        var nextVal = (this.data[i + 1] && this.data[i + 1][j]) || null\n        // console.log(`i=${i}, j=${j}, curVal=${curVal}, nextVal=${nextVal}`)\n\n        if (curVal == null && nextVal === null)\n          continue\n\n        if (curVal === nextVal) {\n          same++\n        } else {\n          if (same >= 3) {\n            // console.log(`(${i},${j})`)\n            this.proxy.score += same;\n            this.proxy.sendNotification(GameProxy.CHANGE_SCORE, this.proxy.score)\n            var num = same\n            var grid = ``\n            while (num) {\n              var row = i - (num - 1)\n              var col = j\n              // console.log(row, col, num)\n              arr.push([row, col])\n\n              grid += `(${row},${col})`\n\n              num--\n            }\n            console.log(`纵向：连续${same}个相同${grid},值为${curVal}`)\n          }\n\n          same = 1\n        }\n      }\n    }\n    return arr\n  }\n\n  getAnimalIndex() {\n    return (parseInt(String(Math.random() * 8)) + 1)\n  }\n}","export default class Game extends PIXI.Application {\n\n  public static NAME = \"game\"\n\n  public static NUM = 0\n\n  constructor(config) {\n    super(config)\n    Game.NAME = \"game\" + Game.NUM++\n\n    this.view.style.width = \"100%\";\n    document.body.appendChild(this.view)\n  }\n\n  public get stageWidth() {\n    return this.screen.width\n  }\n\n  public get stageHeight() {\n    return this.screen.height\n  }\n}","import Mediator = puremvc.Mediator;\nimport IMediator = puremvc.IMediator;\nimport LoadingScene from \"./view/loading/LoadingScene\"\nimport {SceneEvent} from \"./view/Scene\";\nimport SceneCommand from \"../command/SceneCommand\";\n\nexport default class LoadingMediator extends Mediator implements IMediator {\n  public static NAME: string = \"loading_scene_mediator\"\n\n  constructor(viewComponent: any) {\n    super(LoadingMediator.NAME, viewComponent)\n    this.loadingScene.on(SceneEvent.INIT_COMPLETE, this.initComplete, this);\n  }\n\n  private initComplete() {\n    var assetLoader = new PIXI[\"Loader\"]();\n    assetLoader.add([\n      \"./resources/images/main_background.jpg\",\n      \"./resources/images/animal1.png\",\n      \"./resources/images/animal2.png\",\n      \"./resources/images/animal3.png\",\n      \"./resources/images/animal4.png\",\n      \"./resources/images/animal5.png\",\n      \"./resources/images/animal6.png\",\n      \"./resources/images/animal7.png\",\n      \"./resources/images/animal8.png\",\n    ]);\n    assetLoader.once(\"complete\", () => {\n      setTimeout(() => {\n        // this.sendNotification(SceneCommand.TO_START, {from: this.loadingScene});\n        this.sendNotification(SceneCommand.TO_GAME, {from: this.loadingScene});\n      }, 500)\n    });\n    assetLoader.on(\"progress\", (e) => {\n      console.log(\"加载百分比\" + e.progress + \"%\");\n    });\n    assetLoader.load();\n  }\n\n  public get loadingScene() {\n    return this.viewComponent as LoadingScene\n  }\n}","import Mediator = puremvc.Mediator;\nimport IMediator = puremvc.IMediator;\nimport INotification = puremvc.INotification;\nimport StartScene from \"./view/start/StartScene\"\nimport SceneCommand from \"../command/SceneCommand\";\n\nexport default class StartSceneMediator extends Mediator implements IMediator {\n  public static NAME: string = \"start_scene_mediator\"\n\n  constructor(viewComponent: any) {\n    super(StartSceneMediator.NAME, viewComponent)\n\n    this.startScene.on(StartScene.CLICK_START, () => {\n      this.sendNotification(SceneCommand.TO_GAME, {from: this.startScene});\n    })\n  }\n\n  public listNotificationInterests(): string[] {\n    return []\n  }\n\n  public handleNotification(notification: INotification): void {\n    switch (notification.getName()) {\n      default:\n        break\n    }\n  }\n\n  get startScene(): StartScene {\n    return (this.viewComponent as StartScene)\n  }\n}","import Scene from \"../Scene\";\r\n\r\nexport default class StartScene extends Scene {\r\n\r\n  public static NAME = \"start_scene\";\r\n\r\n  public static CLICK_START: string = \"click_start\"\r\n\r\n  constructor(game) {\r\n    super(game)\r\n  }\r\n\r\n  public init() {\r\n    var _stage2Container;\r\n    var _pic4, _pic5;\r\n    var _btn2;\r\n    var _txt1;\r\n\r\n    _stage2Container = new PIXI.Container();\r\n    this.addChild(_stage2Container);\r\n\r\n    _txt1 = new PIXI.Text(\"Text1\", {fill: \"#FFFFFF\"});\r\n    _stage2Container.addChild(_txt1);\r\n    _txt1.x = this.stageWidth / 2;\r\n    _txt1.y = this.stageHeight;\r\n    _txt1.anchor.x = 0.5;\r\n    _txt1.anchor.y = 1;\r\n    _txt1.alpha = 0;\r\n    window.TweenMax.to(_txt1, 1, {alpha: 1, ease: window.Strong.easeOut, delay: 1});\r\n    window.TweenMax.to(_txt1.position, 1, {y: this.stageHeight - 760, ease: window.Elastic.easeOut, delay: 0.8});\r\n    _txt1.name = \"txt1\";\r\n\r\n    _txt1.rotation = -0.05;\r\n    window.TweenMax.to(_txt1, 0.1, {rotation: 0.1, ease: window.Linear.easeNone, repeat: -1, yoyo: true, delay: 1.2});\r\n\r\n    _pic4 = PIXI.Sprite.from(\"pic4.jpg\");\r\n    _pic4.position.x = 0;\r\n    _pic4.position.y = 100;\r\n    _stage2Container.addChild(_pic4);\r\n    _pic4.alpha = 0;\r\n    window.TweenMax.to(_pic4, 0.6, {alpha: 1});\r\n\r\n    _pic5 = PIXI.Sprite.from(\"pic5.png\");\r\n    _pic5.anchor.x = 0.5;\r\n    _pic5.anchor.y = 0.5;\r\n    _pic5.position.x = this.stageWidth / 2;\r\n    _pic5.position.y = this.stageHeight / 2;\r\n    _stage2Container.addChild(_pic5);\r\n    _pic5.scale.x = _pic5.scale.y = 0;\r\n    window.TweenMax.to(_pic5.scale, 1, {x: 1, y: 1, ease: window.Elastic.easeOut, delay: 0.8});\r\n\r\n    _btn2 = PIXI.Sprite.from(\"btn2.jpg\");\r\n    _btn2.anchor.x = 0.5;\r\n    _btn2.anchor.y = 0.5;\r\n    _btn2.position.x = this.stageWidth / 2;\r\n    _btn2.position.y = _pic5.position.y + 240;\r\n    _stage2Container.addChild(_btn2);\r\n    _btn2.scale.x = _btn2.scale.y = 0;\r\n    window.TweenMax.to(_btn2.scale, 1, {x: 1, y: 1, ease: window.Elastic.easeOut, delay: 0.9});\r\n\r\n    _btn2.interactive = true;\r\n    _btn2.mousedown = _btn2.touchstart = () => {\r\n      this.sceneOut()\r\n    }\r\n\r\n    // setTimeout(() => {\r\n    //   this.sceneOut()\r\n    // }, 500)\r\n  }\r\n\r\n  public sceneOut() {\r\n    window.TweenMax.to(this, 0.4, {\r\n      alpha: 0,\r\n      onComplete: () => {\r\n        this.emit(StartScene.CLICK_START)\r\n      }\r\n    });\r\n  }\r\n}\r\n","import Mediator = puremvc.Mediator;\nimport IMediator = puremvc.IMediator;\nimport INotification = puremvc.INotification;\nimport GameScene from \"./view/game/GameScene\";\nimport GameCommand from \"../command/GameCommand\";\nimport GameProxy from \"../proxy/GameProxy\";\nimport {SceneEvent} from \"./view/Scene\";\n\nexport default class GameSceneMediator extends Mediator implements IMediator {\n  public static NAME: string = \"game_scene_mediator\"\n\n  constructor(viewComponent: any) {\n    super(GameSceneMediator.NAME, viewComponent)\n\n    this.gameScene.on(SceneEvent.INIT_COMPLETE, () => {\n      this.sendNotification(GameCommand.CHECK)\n    })\n\n    this.gameScene.on(GameScene.CLICK_FRUIT, ({row, col, value}) => {\n      this.sendNotification(GameCommand.ADD_FRUIT_STACK, {row, col, value})\n    })\n  }\n\n  public listNotificationInterests(): string[] {\n    return [\n      GameProxy.ADD_FRUIT,\n      GameProxy.DELETE_FRUIT,\n      GameProxy.DROP_FRUIT,\n      GameProxy.SWAP_FRUIT,\n      GameProxy.CHANGE_SCORE,\n    ]\n  }\n\n  public handleNotification(notification: INotification): void {\n    console.log(\"GameSceneMediator notification:\", notification)\n    let name = notification.getName()\n    let body = notification.getBody()\n    let type = notification.getType()\n\n    switch (name) {\n      case GameProxy.ADD_FRUIT:\n        this.gameScene.addFruit(body)\n        break;\n      case GameProxy.DELETE_FRUIT:\n        this.gameScene.deleteFruit(body)\n        break;\n      case GameProxy.DROP_FRUIT:\n        this.gameScene.dropFruit(body)\n        break;\n      case GameProxy.SWAP_FRUIT:\n        this.gameScene.swapFruit(body, type)\n        break;\n      case GameProxy.CHANGE_SCORE:\n        this.gameScene.updateScore(body)\n        break;\n    }\n  }\n\n  get gameScene(): GameScene {\n    return (this.viewComponent as GameScene)\n  }\n}","import Container = PIXI.Container\r\nimport Graphics = PIXI.Graphics\r\nimport Sprite = PIXI.Sprite\r\nimport Text = PIXI.Text\r\n\r\nimport Scene, {SceneEvent} from \"../Scene\";\r\nimport Map from \"../../../proxy/model/Map\";\r\nimport Fruit from \"./Fruit\";\r\n\r\nexport default class GameScene extends Scene {\r\n\r\n  public static NAME = \"game_scene\";\r\n\r\n  public static CLICK_FRUIT = \"click_fruit\";\r\n\r\n  private fruits = {}\r\n\r\n  private scoreText: Text = null;\r\n  private animalContainer: Container = null;\r\n\r\n  constructor(game) {\r\n    super(game)\r\n  }\r\n\r\n  public init(map?: any) {\r\n    super.init(map);\r\n\r\n    this.filters = [new PIXI.filters[\"GodrayFilter\"]({alpha: 0.5})];\r\n\r\n    let {rows, cols, data} = map;\r\n\r\n    let bgImage = Sprite.from(\"./resources/images/main_background.jpg\")\r\n    this.addChild(bgImage)\r\n\r\n    var scoreText = new Text(``, {\r\n      fill: 0xffffff,\r\n      fontSize: 64,\r\n    });\r\n    this.addChild(scoreText);\r\n    scoreText.anchor.set(0.5, 0.5);\r\n    scoreText.x = this.stageWidth / 2;\r\n    scoreText.y = 100;\r\n    scoreText.filters = [\r\n      new PIXI.filters[\"GlowFilter\"]({color: 0x00ff6e, distance: 15, innerStrength: 0.1, outerStrength: 2.5})\r\n    ];\r\n    this.scoreText = scoreText;\r\n    this.updateScore(0);\r\n\r\n    var animalContainer = new Container();\r\n    this.addChild(animalContainer);\r\n    animalContainer.x = (this.stageWidth - cols * Map.GridWidth) / 2\r\n    animalContainer.y = (this.stageHeight - rows * Map.GridHeight) / 2\r\n    this.animalContainer = animalContainer;\r\n\r\n    let bg = new Graphics()\r\n    animalContainer.addChild(bg)\r\n\r\n    for (var i = 0; i < rows; i++) {\r\n      for (var j = 0; j < cols; j++) {\r\n        let startX = j * Map.GridWidth\r\n        let startY = i * Map.GridHeight\r\n\r\n        bg.beginFill(\r\n          0x000000,\r\n          i % 2 === 0\r\n            ? j % 2 === 0 ? 0.6 : 0.4\r\n            : j % 2 !== 0 ? 0.6 : 0.4\r\n        )\r\n        bg.moveTo(startX, startY)\r\n        bg.lineTo(startX + Map.GridWidth, startY)\r\n        bg.lineTo(startX + Map.GridWidth, startY + Map.GridHeight)\r\n        bg.lineTo(startX, startY + Map.GridHeight)\r\n        bg.closePath()\r\n        bg.endFill()\r\n\r\n        this.addFruit({\r\n          row: i,\r\n          col: j,\r\n          value: data[i][j],\r\n          animate: {\r\n            from: {x: (cols * Map.GridWidth) / 2, y: 0},\r\n            to: {x: (j * Map.GridWidth + Map.GridWidth / 2), y: (i * Map.GridHeight + Map.GridHeight / 2)}\r\n          }\r\n        })\r\n      }\r\n    }\r\n\r\n    setTimeout(() => {\r\n      this.emit(SceneEvent.INIT_COMPLETE)\r\n    }, 1000)\r\n  }\r\n\r\n  public addFruit(data) {\r\n    if (!Array.isArray(data)) {\r\n      data = [data]\r\n    }\r\n\r\n    data.forEach(({row, col, value, animate}) => {\r\n      var fruit = new Fruit(row, col, value)\r\n      this.animalContainer.addChild(fruit)\r\n      if (animate) {\r\n        let {from, to} = animate\r\n        window.TweenMax.fromTo([fruit], 0.3, from, to);\r\n      } else {\r\n        fruit.x = (col * Map.GridWidth + Map.GridWidth / 2)\r\n        fruit.y = (row * Map.GridHeight + Map.GridHeight / 2)\r\n      }\r\n\r\n      fruit.on(\"pointerdown\", (event) => {\r\n        fruit.filters = [new PIXI.filters[\"OutlineFilter\"](2, 0x99ff99)];\r\n        this.emit(GameScene.CLICK_FRUIT, event.currentTarget)\r\n      })\r\n      this.fruits[`${row}_${col}`] = fruit;\r\n    })\r\n  }\r\n\r\n  public swapFruit([node1, node2], type) {\r\n    let {row: row1, col: col1} = node1;\r\n    let {row: row2, col: col2} = node2;\r\n    let fruit1 = this.fruits[`${row1}_${col1}`]\r\n    let fruit2 = this.fruits[`${row2}_${col2}`]\r\n\r\n    if (type === \"success\") {\r\n      fruit1.setRowCol(row2, col2)\r\n      fruit2.setRowCol(row1, col1)\r\n      this.fruits[`${row1}_${col1}`] = fruit2\r\n      this.fruits[`${row2}_${col2}`] = fruit1\r\n      setTimeout(() => {\r\n        fruit1.filters = []\r\n        fruit2.filters = []\r\n      }, 300)\r\n    } else if (type === \"fail\") {\r\n      fruit1.rotation = -0.05;\r\n      fruit2.rotation = -0.05;\r\n      window.TweenMax.to(fruit1, 0.1, {rotation: 0.1, ease: window.Linear.easeNone, repeat: 5, yoyo: true});\r\n      window.TweenMax.to(fruit2, 0.1, {rotation: 0.1, ease: window.Linear.easeNone, repeat: 5, yoyo: true});\r\n      setTimeout(() => {\r\n        fruit1.filters = []\r\n        fruit2.filters = []\r\n      }, 300)\r\n    }\r\n  }\r\n\r\n  public deleteFruit(data) {\r\n    var arr = [];\r\n\r\n    data.forEach((item1) => {\r\n      var result = arr.find(item2 => (item1[0] === item2[0] && item1[1] === item2[1]))\r\n      if (!result) {\r\n        arr.push(item1)\r\n      }\r\n    })\r\n\r\n    arr.forEach(([row, col]) => {\r\n      let fruit = this.fruits[`${row}_${col}`]\r\n      window.TweenMax.to(fruit.scale, 1, {x: 0, y: 0, ease: \"power1.inOut\"})\r\n      window.TweenMax.to(fruit, 1, {alpha: 0, ease: \"none\"})\r\n      this.fruits[`${row}_${col}`] = null;\r\n    })\r\n  }\r\n\r\n  public dropFruit(data) {\r\n    for (var key in data) {\r\n      data[key].forEach(({row, col, drop}) => {\r\n        let fruit = this.fruits[`${row}_${col}`]\r\n        fruit.setRowCol(row + drop, col)\r\n\r\n        this.fruits[`${row}_${col}`] = null;\r\n        this.fruits[`${row + drop}_${col}`] = fruit;\r\n      })\r\n    }\r\n  }\r\n\r\n  public updateScore(score) {\r\n    if (score < 1000) {\r\n      score = `000${score}`\r\n    } else if (score < 100) {\r\n      score = `00${score}`\r\n    } else if (score < 10) {\r\n      score = `0${score}`\r\n    }\r\n    this.scoreText.text = `Score: ` + score;\r\n  }\r\n}","import SimpleCommand = puremvc.SimpleCommand\nimport ICommand = puremvc.ICommand\nimport INotification = puremvc.INotification\nimport GameProxy from \"../proxy/GameProxy\";\n\nexport default class GameCommand extends SimpleCommand implements ICommand {\n\n  public static ADD_FRUIT_STACK = \"add_fruit_stack\"\n\n  public static CHECK = \"check\"\n\n  constructor() {\n    super()\n  }\n\n  public execute(notification: INotification) {\n    console.log(\"SceneCommand notification:\", notification)\n\n    let name = notification.getName()\n    let body = notification.getBody()\n\n    let gameProxy: GameProxy = this.facade.retrieveProxy(GameProxy.NAME) as GameProxy\n\n    switch (name) {\n      case GameCommand.ADD_FRUIT_STACK:\n        gameProxy.addSwapFruit(body)\n        break\n      case GameCommand.CHECK:\n        gameProxy.map.check();\n        break;\n    }\n  }\n}","import Game from \"./Game\"\nimport ApplicationFacade from \"./org/ApplicationFacade\";\n\nApplicationFacade.getInstance(Game.NAME).startup();","import Facade = puremvc.Facade;\nimport IFacade = puremvc.IFacade;\n\nimport Game from \"../Game\";\nimport SceneCommand from \"./command/SceneCommand\";\nimport StartupCommand from \"./command/startup/StartupCommand\";\n\nexport default class ApplicationFacade extends Facade implements IFacade {\n\n  public static STARTUP = \"startup\"\n\n  public static instance = null\n\n  private _game: Game = null\n\n  constructor(key) {\n    super(key)\n  }\n\n  public static getInstance(key): ApplicationFacade {\n    if (null == key) return null\n\n    if (Facade.instanceMap[key] == null) {\n      Facade.instanceMap[key] = new ApplicationFacade(key)\n    }\n\n    return Facade.instanceMap[key]\n  }\n\n  public initializeModel(): void {\n    super.initializeModel()\n  }\n\n  public initializeView(): void {\n    super.initializeView();\n  }\n\n  public initializeController(): void {\n    super.initializeController()\n\n    this.registerCommand(ApplicationFacade.STARTUP, StartupCommand)\n  }\n\n  public startup() {\n    let windowWidth = document.documentElement.clientWidth || document.body.clientWidth\n    let windowHeight = document.documentElement.clientHeight || document.body.clientHeight\n    let windowRatio = windowWidth / windowHeight\n\n    let stageWidth = 640\n    let stageHeight = (windowHeight > windowWidth)\n      ? windowHeight / windowWidth * stageWidth\n      : windowWidth / windowHeight * stageWidth;\n\n    this.game = new Game({\n      width: stageWidth,\n      height: stageHeight,\n      backgroundColor: 0x1099bb\n    })\n\n    this.sendNotification(ApplicationFacade.STARTUP, this.game)\n    this.removeCommand(ApplicationFacade.STARTUP)\n\n    this.sendNotification(SceneCommand.TO_LOADING, {from: null})\n  }\n\n  public destory() {\n    if (this.game) {\n      this.game.destroy(true)\n      this.game = null\n    }\n\n    window.TweenMax.killAll()\n  }\n\n  public set game(value) {\n    this._game = value;\n  }\n\n  public get game() {\n    return this._game;\n  }\n}","import Map from \"../../../proxy/model/Map\";\n\nexport default class Fruit extends PIXI.Container {\n\n  public text: any = null;\n  public row: any = null;\n  public col: any = null;\n  public value: any = null;\n\n  constructor(row, col, value) {\n    super()\n    this.row = row\n    this.col = col\n    this.value = value\n    var sprite = PIXI.Sprite.from(`./resources/images/animal${value}.png`)\n    this.addChild(sprite)\n    sprite.anchor.set(0.5)\n\n    let text = new PIXI.Text(``, {fontSize: 10, fill: 0xffffff,})\n    this.addChild(text)\n    text.anchor.set(0.5, 0.5)\n    this.text = text\n\n    this.buttonMode = true\n    this.interactive = true\n\n    this.update();\n  }\n\n  setRowCol(row, col, move = true) {\n    this.row = row;\n    this.col = col;\n    this.update();\n\n    let x = col * Map.GridWidth + Map.GridWidth / 2\n    let y = row * Map.GridHeight + Map.GridHeight / 2\n\n    if (move) {\n      window.TweenMax.to(this, 0.3, {x, y, ease: \"none\"})\n    } else {\n      this.x = x;\n      this.y = y;\n    }\n  }\n\n  update() {\n    // this.text.text = `(${this.row},${this.col}) ${this.value}`\n  }\n}","import MacroCommand = puremvc.MacroCommand;\nimport ICommand = puremvc.ICommand;\nimport ModelPrepCommand from \"./ModelPrepCommand\"\nimport ViewPrepCommand from \"./ViewPrepCommand\"\nimport ControllerPrepCommand from \"./ControllerPrepCommand\"\n\nexport default class StartupCommand extends MacroCommand implements ICommand {\n  constructor() {\n    super()\n  }\n\n  public initializeMacroCommand() {\n    this.addSubCommand(ModelPrepCommand)\n    this.addSubCommand(ViewPrepCommand)\n    this.addSubCommand(ControllerPrepCommand)\n  }\n}","import SimpleCommand = puremvc.SimpleCommand;\nimport GameProxy from \"../../proxy/GameProxy\"\n\nexport default class ModelPrepCommand extends SimpleCommand {\n  constructor() {\n    super()\n  }\n\n  public execute() {\n    this.facade.registerProxy(new GameProxy())\n  }\n}","import SimpleCommand = puremvc.SimpleCommand;\nimport INotification = puremvc.INotification;\n\nimport Game from \"../../../Game\"\nimport StartScene from \"../../mediator/view/start/StartScene\";\nimport StartSceneMediator from \"../../mediator/StartSceneMediator\";\nimport LoadingScene from \"../../mediator/view/loading/LoadingScene\";\nimport LoadingMediator from \"../../mediator/LoadingSceneMediator\";\nimport GameScene from \"../../mediator/view/game/GameScene\";\nimport GameSceneMediator from \"../../mediator/GameSceneMediator\";\n\nexport default class ViewPrepCommand extends SimpleCommand {\n  constructor() {\n    super()\n  }\n\n  public execute(note: INotification) {\n    var game: Game = note.getBody() as Game\n\n    let loadingScene = new LoadingScene(game);\n    this.facade.registerMediator(new LoadingMediator(loadingScene))\n\n    let startScene = new StartScene(game);\n    this.facade.registerMediator(new StartSceneMediator(startScene))\n\n    let gameScene = new GameScene(game);\n    this.facade.registerMediator(new GameSceneMediator(gameScene))\n  }\n}","import Scene, {SceneEvent} from \"../Scene\";\nimport Text = PIXI.Text;\n\nexport default class LoadingScene extends Scene {\n  public static NAME = \"loading_scene\"\n\n  constructor(game) {\n    super(game)\n  }\n\n  public init() {\n    let _txt1 = new Text(\"加载中...\", {fill: \"#FFFFFF\"});\n    this.addChild(_txt1);\n    _txt1.anchor.set(0.5, 0.5);\n    _txt1.x = this.stageWidth / 2;\n    _txt1.y = this.stageHeight / 2;\n\n    this.emit(SceneEvent.INIT_COMPLETE)\n  }\n}","import SimpleCommand = puremvc.SimpleCommand;\nimport ICommand = puremvc.ICommand\nimport SceneCommand from \"../SceneCommand\"\nimport GameCommand from \"../GameCommand\";\n\nexport default class ControllerPrepCommand extends SimpleCommand implements ICommand {\n  constructor() {\n    super()\n  }\n\n  public execute() {\n    this.facade.registerCommand(SceneCommand.TO_LOADING, SceneCommand)\n    this.facade.registerCommand(SceneCommand.TO_START, SceneCommand)\n    this.facade.registerCommand(SceneCommand.TO_GAME, SceneCommand)\n\n    this.facade.registerCommand(GameCommand.CHECK, GameCommand)\n    this.facade.registerCommand(GameCommand.ADD_FRUIT_STACK, GameCommand)\n  }\n}"],"sourceRoot":""}